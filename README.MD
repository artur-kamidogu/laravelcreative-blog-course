//TODO –ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å 

Docker –¥–ª—è Laravel –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–æ—Å—Ç–æ–≥–æ —É—Ä–æ–≤–Ω—è

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
project/
‚îú‚îÄ‚îÄ _docker/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PHP-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ php.ini         # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ PHP
‚îÇ   ‚îî‚îÄ‚îÄ nginx/
‚îÇ       ‚îî‚îÄ‚îÄ conf.d/
‚îÇ           ‚îî‚îÄ‚îÄ nginx.conf  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx
‚îú‚îÄ‚îÄ docker-compose.yml      # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
‚îî‚îÄ‚îÄ src/                    # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ù–ï –ó–ê–ë–£–î–¨ –ü–û–ü–†–ê–í–ò–¢–¨ .env –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ 
```

---

## üê≥ –§–∞–π–ª docker-compose.yml
```yaml
services:
  nginx:
    image: nginx
    volumes:
      - ./src:/var/www/                    # –°–≤—è–∑–∫–∞ —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º
      - ./_docker/nginx/conf.d/:/etc/nginx/conf.d/  # –ö–æ–Ω—Ñ–∏–≥–∏ Nginx
    ports:
      - "8088:80"                          # –õ–æ–∫–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç 8088 ‚Üí –ø–æ—Ä—Ç 80 –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
    depends_on:
      - app                                # –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å app
    container_name: project_nginx
  
  app:
    build:
      context: .                           # –¢–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∫–∞–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å–±–æ—Ä–∫–∏
      dockerfile: _docker/app/Dockerfile   # –ü—É—Ç—å –∫ Dockerfile
    volumes:
      - ./src:/var/www/                    # –û–±—â–∏–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ–¥—É
    container_name: project_app
```
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –°–æ–∑–¥–∞–µ—Ç –¥–≤–∞ —Å–µ—Ä–≤–∏—Å–∞: Nginx (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä) –∏ app (PHP-FPM)
- –ú–∞–ø–ø–∏—Ç –ø–∞–ø–∫–∏ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏


---

## üêò Dockerfile PHP (app)
```dockerfile
FROM php:8.1-fpm                          # –ë–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ PHP 8.1 —Å FastCGI

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
RUN apt-get update && apt-get install -y \
      apt-utils \                         # –£—Ç–∏–ª–∏—Ç—ã apt
      libpq-dev \                         # –î–ª—è —Ä–∞–±–æ—Ç—ã —Å PostgreSQL
      libpng-dev \                        # –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
      libzip-dev \                        # –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞—Ä—Ö–∏–≤–∞–º–∏
      zip unzip \                         # –ê—Ä—Ö–∏–≤–∞—Ç–æ—Ä—ã
      git && \                            # Git –¥–ª—è composer
      docker-php-ext-install pdo_mysql && \  # –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ MySQL
      docker-php-ext-install bcmath && \     # –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
      docker-php-ext-install gd && \         # –†–∞–±–æ—Ç–∞ —Å –≥—Ä–∞—Ñ–∏–∫–æ–π
      docker-php-ext-install zip && \        # –†–∞–±–æ—Ç–∞ —Å ZIP
      apt-get clean && \                     # –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
      rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ PHP
COPY ./_docker/app/php.ini /usr/local/etc/php/conf.d/php.ini

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Composer
ENV COMPOSER_ALLOW_SUPERUSER=1            # –†–∞–∑—Ä–µ—à–∏—Ç—å —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
RUN curl -sS https://getcomposer.org/installer | php -- \
    --filename=composer \
    --install-dir=/usr/local/bin          # –ì–ª–æ–±–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Composer

WORKDIR /var/www                          # –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
```
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –°–æ–±–∏—Ä–∞–µ—Ç –æ–±—Ä–∞–∑ —Å PHP 8.1 –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Composer –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ PHP
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## ‚öôÔ∏è –§–∞–π–ª php.ini
```ini
cgi.fix_pathinfo=0        # –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –Ω–µ –∏—Å–ø–æ–ª–Ω—è—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
max_execution_time = 1000 # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ (—Å–µ–∫)
max_input_time = 1000     # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
memory_limit=4G           # –õ–∏–º–∏—Ç –ø–∞–º—è—Ç–∏ –¥–ª—è PHP
```

---

## üåê –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx (nginx.conf)
```nginx
server {
    index index.html index.php;           # –§–∞–π–ª—ã –∏–Ω–¥–µ–∫—Å–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    error_log  /var/log/nginx/error.log;  # –õ–æ–≥ –æ—à–∏–±–æ–∫
    access_log /var/log/nginx/access.log; # –õ–æ–≥ –¥–æ—Å—Ç—É–ø–∞
    root /var/www/public;                 # –ö–æ—Ä–Ω–µ–≤–∞—è –ø–∞–ø–∫–∞ Laravel

    location / {
        try_files $uri /index.php;        # –†–æ—É—Ç–∏–Ω–≥ —á–µ—Ä–µ–∑ index.php
        # –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
        add_header Last-Modified $date_gmt;
        add_header Cache-Control 'no-store, no-cache';
        if_modified_since off;
        expires off;
        etag off;
    }

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ PHP —Ñ–∞–π–ª–æ–≤
    location ~ \.php$ {
       try_files $uri =404;               # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
       fastcgi_split_path_info ^(.+\.php)(/.+)$;
       fastcgi_pass app:9000;             # –ü–µ—Ä–µ–¥–∞—á–∞ –≤ PHP-FPM –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
       fastcgi_index index.php;
       include fastcgi_params;            # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã FastCGI
       fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
       fastcgi_param PATH_INFO $fastcgi_path_info;
    }
}
```

---

## üöÄ –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ Laravel

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Laravel –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ app
```bash
`docker exec -it project_app composer create-project laravel/laravel .`
```
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ Laravel –≤ –ø–∞–ø–∫—É `/var/www/` –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–æ–π `src/` —á–µ—Ä–µ–∑ volume

### 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–µ—Å–ª–∏ –æ—à–∏–±–∫–∞ 500)
```bash
docker exec -it project_app php artisan key:generate
```
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `APP_KEY` –≤ `.env` —Ñ–∞–π–ª–µ Laravel
- –†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É "No application encryption key has been specified"

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
```bash
docker exec -it project_app chmod -R 775 storage bootstrap/cache
```

---

## üìå –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### –°–≤—è–∑–∫–∞ –ø–∞–ø–æ–∫ (volumes)
- `./src:/var/www/` ‚Äî –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–µ–Ω –∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, –∏ –ª–æ–∫–∞–ª—å–Ω–æ
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–µ `src/` —Å—Ä–∞–∑—É –≤–∏–¥–Ω—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

### –ü–æ—Ä—Ç—ã
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8088`
- Nginx —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç 80 –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç 8088

### –°–µ—Ä–≤–∏—Å—ã
- **Nginx** ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç HTTP –∑–∞–ø—Ä–æ—Å—ã, –æ—Ç–¥–∞–µ—Ç —Å—Ç–∞—Ç–∏–∫—É, –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç PHP
- **app (PHP-FPM)** ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç PHP –∫–æ–¥, —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 9000

---

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ó–∞–ø—É—Å–∫
docker compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker compose down

# –õ–æ–≥–∏
docker compose logs -f nginx
docker compose logs -f app

# –í—Ö–æ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker exec -it project_app bash
docker exec -it project_nginx bash

# Composer –∫–æ–º–∞–Ω–¥—ã
docker exec -it project_app composer install
docker exec -it project_app composer update

# Artisan –∫–æ–º–∞–Ω–¥—ã
docker exec -it project_app php artisan migrate
docker exec -it project_app php artisan tinker
```

---

## ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –û—à–∏–±–∫–∞ 500 –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Laravel
```bash
# –†–µ—à–µ–Ω–∏–µ:
docker exec -it project_app php artisan key:generate
docker exec -it project_app php artisan cache:clear
```

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è
```bash
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ Nginx:
docker exec -it project_nginx nginx -s reload
```

### Composer —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏
```bash
# –í —Ñ–∞–π–ª–µ php.ini —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ memory_limit=4G
```